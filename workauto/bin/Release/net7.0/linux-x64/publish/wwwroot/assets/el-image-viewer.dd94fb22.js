var _e=Object.defineProperty,Ie=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var de=(o,l,a)=>l in o?_e(o,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[l]=a,H=(o,l)=>{for(var a in l||(l={}))Ee.call(l,a)&&de(o,a,l[a]);if(ce)for(var a of ce(l))Ce.call(l,a)&&de(o,a,l[a]);return o},G=(o,l)=>Ie(o,Le(l));import{g as xe,e as $,m as fe,i as ne,u as ve,n as ze,E as O,k as B,f as V,p as Oe,o as Se,w as Te,x as Ne}from"./index.f3818ef9.js";import{j as me,aw as pe,h as w,ax as $e,a4 as Ae,k as y,w as se,E as ge,i as we,o as h,e as le,K as c,p as E,x as p,t as d,u as t,D as Re,J as k,m as S,L as oe,q as Me,M as Be,y as Ve,W as De,n as re,s as J,$ as Ye,am as Fe,ai as Xe,a1 as je,l as He,C as Pe}from"./vendor.eff3b74f.js";import{i as We,e as ye,f as ie,$ as Ze,a0 as qe,u as he,x as Ke,a1 as Ge,j as Je,a2 as Ue,A as Qe,a3 as et,a4 as tt,_ as ke,a5 as at,w as be}from"./base.0eca82ef.js";var nt="Expected a function";function ue(o,l,a){var r=!0,T=!0;if(typeof o!="function")throw new TypeError(nt);return We(a)&&(r="leading"in a?!!a.leading:r,T="trailing"in a?!!a.trailing:T),xe(o,l,{leading:r,maxWait:l,trailing:T})}const st=(o,l)=>{if(!$||!o||!l)return!1;const a=o.getBoundingClientRect();let r;return l instanceof Element?r=l.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},a.top<r.bottom&&a.bottom>r.top&&a.right>r.left&&a.left<r.right},lt=()=>$&&/firefox/i.test(window.navigator.userAgent),ot=ye({urlList:{type:ie(Array),default:()=>fe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),rt={close:()=>!0,switch:o=>ne(o)},it=["src"],ut={name:"ElImageViewer"},ct=me(G(H({},ut),{props:ot,emits:rt,setup(o,{emit:l}){const a=o,r={CONTAIN:{name:"contain",icon:pe(Ze)},ORIGINAL:{name:"original",icon:pe(qe)}},T=lt()?"DOMMouseScroll":"mousewheel",{t:C}=ve(),i=he("image-viewer"),{nextZIndex:U}=ze(),N=w(),b=w([]),_=$e(),I=w(!0),f=w(a.initialIndex),m=Ae(r.CONTAIN),u=w({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),D=y(()=>{const{urlList:n}=a;return n.length<=1}),A=y(()=>f.value===0),P=y(()=>f.value===a.urlList.length-1),Q=y(()=>a.urlList[f.value]),Y=y(()=>{const{scale:n,deg:e,offsetX:s,offsetY:v,enableTransition:x}=u.value;let g=s/n,z=v/n;switch(e%360){case 90:case-270:[g,z]=[z,-g];break;case 180:case-180:[g,z]=[-g,-z];break;case 270:case-90:[g,z]=[-z,g];break}const M={transform:`scale(${n}) rotate(${e}deg) translate(${g}px, ${z}px)`,transition:x?"transform .3s":""};return m.value.name===r.CONTAIN.name&&(M.maxWidth=M.maxHeight="100%"),M}),ee=y(()=>ne(a.zIndex)?a.zIndex:U());function R(){te(),l("close")}function F(){const n=ue(s=>{switch(s.code){case V.esc:a.closeOnPressEscape&&R();break;case V.space:j();break;case V.left:q();break;case V.up:L("zoomIn");break;case V.right:K();break;case V.down:L("zoomOut");break}}),e=ue(s=>{(s.wheelDelta?s.wheelDelta:-s.detail)>0?L("zoomIn",{zoomRate:1.2,enableTransition:!1}):L("zoomOut",{zoomRate:1.2,enableTransition:!1})});_.run(()=>{B(document,"keydown",n),B(document,T,e)})}function te(){_.stop()}function ae(){I.value=!1}function W(n){I.value=!1,n.target.alt=C("el.image.error")}function Z(n){if(I.value||n.button!==0||!N.value)return;u.value.enableTransition=!1;const{offsetX:e,offsetY:s}=u.value,v=n.pageX,x=n.pageY,g=ue(M=>{u.value=G(H({},u.value),{offsetX:e+M.pageX-v,offsetY:s+M.pageY-x})}),z=B(document,"mousemove",g);B(document,"mouseup",()=>{z()}),n.preventDefault()}function X(){u.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function j(){if(I.value)return;const n=at(r),e=Object.values(r),s=m.value.name,x=(e.findIndex(g=>g.name===s)+1)%n.length;m.value=r[n[x]],X()}function q(){if(A.value&&!a.infinite)return;const n=a.urlList.length;f.value=(f.value-1+n)%n}function K(){if(P.value&&!a.infinite)return;const n=a.urlList.length;f.value=(f.value+1)%n}function L(n,e={}){if(I.value)return;const{zoomRate:s,rotateDeg:v,enableTransition:x}=H({zoomRate:1.4,rotateDeg:90,enableTransition:!0},e);switch(n){case"zoomOut":u.value.scale>.2&&(u.value.scale=Number.parseFloat((u.value.scale/s).toFixed(3)));break;case"zoomIn":u.value.scale<7&&(u.value.scale=Number.parseFloat((u.value.scale*s).toFixed(3)));break;case"clockwise":u.value.deg+=v;break;case"anticlockwise":u.value.deg-=v;break}u.value.enableTransition=x}return se(Q,()=>{ge(()=>{const n=b.value[0];(n==null?void 0:n.complete)||(I.value=!0)})}),se(f,n=>{X(),l("switch",n)}),we(()=>{var n,e;F(),(e=(n=N.value)==null?void 0:n.focus)==null||e.call(n)}),(n,e)=>(h(),le(Fe,{to:"body",disabled:!n.teleported},[c(Ye,{name:"viewer-fade",appear:""},{default:E(()=>[p("div",{ref_key:"wrapper",ref:N,tabindex:-1,class:d(t(i).e("wrapper")),style:re({zIndex:t(ee)})},[p("div",{class:d(t(i).e("mask")),onClick:e[0]||(e[0]=Re(s=>n.hideOnClickModal&&R(),["self"]))},null,2),k(" CLOSE "),p("span",{class:d([t(i).e("btn"),t(i).e("close")]),onClick:R},[c(t(O),null,{default:E(()=>[c(t(Ke))]),_:1})],2),k(" ARROW "),t(D)?k("v-if",!0):(h(),S(oe,{key:0},[p("span",{class:d([t(i).e("btn"),t(i).e("prev"),t(i).is("disabled",!n.infinite&&t(A))]),onClick:q},[c(t(O),null,{default:E(()=>[c(t(Ge))]),_:1})],2),p("span",{class:d([t(i).e("btn"),t(i).e("next"),t(i).is("disabled",!n.infinite&&t(P))]),onClick:K},[c(t(O),null,{default:E(()=>[c(t(Je))]),_:1})],2)],64)),k(" ACTIONS "),p("div",{class:d([t(i).e("btn"),t(i).e("actions")])},[p("div",{class:d(t(i).e("actions__inner"))},[c(t(O),{onClick:e[1]||(e[1]=s=>L("zoomOut"))},{default:E(()=>[c(t(Ue))]),_:1}),c(t(O),{onClick:e[2]||(e[2]=s=>L("zoomIn"))},{default:E(()=>[c(t(Qe))]),_:1}),p("i",{class:d(t(i).e("actions__divider"))},null,2),c(t(O),{onClick:j},{default:E(()=>[(h(),le(Me(t(m).icon)))]),_:1}),p("i",{class:d(t(i).e("actions__divider"))},null,2),c(t(O),{onClick:e[3]||(e[3]=s=>L("anticlockwise"))},{default:E(()=>[c(t(et))]),_:1}),c(t(O),{onClick:e[4]||(e[4]=s=>L("clockwise"))},{default:E(()=>[c(t(tt))]),_:1})],2)],2),k(" CANVAS "),p("div",{class:d(t(i).e("canvas"))},[(h(!0),S(oe,null,Be(n.urlList,(s,v)=>Ve((h(),S("img",{ref_for:!0,ref:x=>b.value[v]=x,key:s,src:s,style:re(t(Y)),class:d(t(i).e("img")),onLoad:ae,onError:W,onMousedown:Z},null,46,it)),[[De,v===f.value]])),128))],2),J(n.$slots,"default")],6)]),_:3})],8,["disabled"]))}}));var dt=ke(ct,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ft=be(dt),vt=ye({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:ie([String,Object])},previewSrcList:{type:ie(Array),default:()=>fe([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),mt={load:o=>o instanceof Event,error:o=>o instanceof Event,switch:o=>ne(o),close:()=>!0,show:()=>!0},pt=["src","loading"],gt={key:0},wt={name:"ElImage",inheritAttrs:!1},yt=me(G(H({},wt),{props:vt,emits:mt,setup(o,{emit:l}){const a=o;let r="";const{t:T}=ve(),C=he("image"),i=Xe(),U=Oe(),N=w(),b=w(!1),_=w(!0),I=w(!1),f=w(),m=w(),u=$&&"loading"in HTMLImageElement.prototype;let D,A;const P=y(()=>i.style),Q=y(()=>{const{fit:e}=a;return $&&e?{objectFit:e}:{}}),Y=y(()=>{const{previewSrcList:e}=a;return Array.isArray(e)&&e.length>0}),ee=y(()=>{const{previewSrcList:e,initialIndex:s}=a;let v=s;return s>e.length-1&&(v=0),v}),R=y(()=>a.loading==="eager"?!1:!u&&a.loading==="lazy"||a.lazy),F=()=>{!$||(_.value=!0,b.value=!1,N.value=a.src)};function te(e){_.value=!1,b.value=!1,l("load",e)}function ae(e){_.value=!1,b.value=!0,l("error",e)}function W(){st(f.value,m.value)&&(F(),j())}const Z=Ne(W,200);async function X(){var e;if(!$)return;await ge();const{scrollContainer:s}=a;Se(s)?m.value=s:He(s)&&s!==""?m.value=(e=document.querySelector(s))!=null?e:void 0:f.value&&(m.value=Te(f.value)),m.value&&(D=B(m,"scroll",Z),setTimeout(()=>W(),100))}function j(){!$||!m.value||!Z||(D==null||D(),m.value=void 0)}function q(e){if(!!e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function K(){!Y.value||(A=B("wheel",q,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",I.value=!0,l("show"))}function L(){A==null||A(),document.body.style.overflow=r,I.value=!1,l("close")}function n(e){l("switch",e)}return se(()=>a.src,()=>{R.value?(_.value=!0,b.value=!1,j(),X()):F()}),we(()=>{R.value?X():F()}),(e,s)=>(h(),S("div",{ref_key:"container",ref:f,class:d([t(C).b(),e.$attrs.class]),style:re(t(P))},[N.value!==void 0&&!b.value?(h(),S("img",je({key:0},t(U),{src:N.value,loading:e.loading,style:t(Q),class:[t(C).e("inner"),t(Y)&&t(C).e("preview"),_.value&&t(C).is("loading")],onClick:K,onLoad:te,onError:ae}),null,16,pt)):k("v-if",!0),_.value||b.value?(h(),S("div",{key:1,class:d(t(C).e("wrapper"))},[_.value?J(e.$slots,"placeholder",{key:0},()=>[p("div",{class:d(t(C).e("placeholder"))},null,2)]):b.value?J(e.$slots,"error",{key:1},()=>[p("div",{class:d(t(C).e("error"))},Pe(t(T)("el.image.error")),3)]):k("v-if",!0)],2)):k("v-if",!0),t(Y)?(h(),S(oe,{key:2},[I.value?(h(),le(t(ft),{key:0,"z-index":e.zIndex,"initial-index":t(ee),infinite:e.infinite,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:L,onSwitch:n},{default:E(()=>[e.$slots.viewer?(h(),S("div",gt,[J(e.$slots,"viewer")])):k("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):k("v-if",!0)],64)):k("v-if",!0)],6))}}));var ht=ke(yt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const Lt=be(ht);export{Lt as E};
